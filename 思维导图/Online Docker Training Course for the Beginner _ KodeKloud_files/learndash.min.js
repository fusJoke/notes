/*! 
 * BuddyBoss Theme JavaScript Library 
 * @package BuddyBoss Theme 
 */
!function(d){"use strict";window.BBLMS={init:function(){this.switchLdGridList(),this.toggleTheme(),this.learnDashSidePanel(),this.lms_user_profile_js(),this.lms_single_course(),this.course_archive_js(),this.quizDetails(),this.quizUpload(),this.setElementorSpacing(),this.courseViewCookie(),this.bbStickyLdSidebar(),this.singleLesson(),this.singleTopic(),this.singleQuiz(),this.showMoreParticipants()},switchLdGridList:function(){var s=d(".bb-course-items:not(.is-cover)");if(window.sessionStorage){var e=sessionStorage.getItem("course-view");null==e&&(sessionStorage.setItem("course-view","grid"),e=sessionStorage.getItem("course-view")),d(".layout-view-course").removeClass("active"),s.removeClass("grid-view"),s.removeClass("bb-grid"),s.removeClass("list-view"),s.removeClass("bb-list"),"grid"===e?(d(".layout-view-course.layout-grid-view").addClass("active"),s.addClass("grid-view"),s.addClass("bb-grid")):(d(".layout-view-course.layout-list-view").addClass("active"),s.addClass("list-view"),s.addClass("bb-list"))}d(document).on("click",".grid-filters .layout-view-course",function(e){e.preventDefault(),s=d(".bb-course-items:not(.is-cover)"),d(this).hasClass("layout-list-view")?(window.sessionStorage&&sessionStorage.setItem("course-view","list"),d(".layout-view-course").removeClass("active"),s.removeClass("grid-view"),s.removeClass("bb-grid"),s.removeClass("list-view"),s.removeClass("bb-list"),d(".layout-view-course.layout-list-view").addClass("active"),s.addClass("list-view"),s.addClass("bb-list"),d.ajax({method:"GET",url:bs_data.ajaxurl,data:"action=buddyboss_lms_save_view&option=bb_theme_learndash_grid_list&type=list",success:function(e){}})):(window.sessionStorage&&sessionStorage.setItem("course-view","grid"),d(".layout-view-course").removeClass("active"),s.removeClass("grid-view"),s.removeClass("bb-grid"),s.removeClass("list-view"),s.removeClass("bb-list"),d(".layout-view-course.layout-grid-view").addClass("active"),s.addClass("grid-view"),s.addClass("bb-grid"),d.ajax({method:"GET",url:bs_data.ajaxurl,data:"action=buddyboss_lms_save_view&option=bb_theme_learndash_grid_list&type=grid",success:function(e){}}))})},showMoreParticipants:function(){var e=d(".lms-course-members-list .lms-course-sidebar-heading .lms-count").text(),s=2,t=d(".lms-course-members-list #buddyboss_theme_learndash_course_participants_course_id").val(),a=d(".lms-course-members-list .bb-course-member-wrap .lme-more i"),i=d(".lms-course-members-list .bb-course-member-wrap .lme-more");d(".lms-course-members-list").on("click",".bb-course-member-wrap .lme-more",function(){d(this).hasClass("loading-members")||(d(this).addClass("loading-members"),a.removeClass("bb-icon-angle-down"),a.addClass("bb-icon-spin"),a.addClass("animate-spin"),d(".lms-course-members-list .bb-course-member-wrap .lme-less").hide(),d.ajax({method:"GET",url:bs_data.ajaxurl,data:"action=buddyboss_lms_get_course_participants&_wpnonce="+bs_data.learndash.nonce_get_courses+"&total="+e+"&page="+s+"&course="+t,success:function(e){d(".lms-course-members-list .bb-course-member-wrap .course-members-list.course-members-list-extra").show(),d(".lms-course-members-list .bb-course-member-wrap .course-members-list-extra").append(e.data.html),d(window).trigger("resize"),"false"===e.data.show_more&&d(".lms-course-members-list .bb-course-member-wrap .lme-more").remove(),s=e.data.page,0===d(".ld-sidebar-widgets").length&&d(".lms-topic-sidebar-wrapper .lms-topic-sidebar-data").animate({scrollTop:d(document).height()},1e3),a.addClass("bb-icon-angle-down"),a.removeClass("bb-icon-spin"),a.removeClass("animate-spin"),i.removeClass("loading-members")}}))})},fetchCourses:function(){for(var i=d("#bb-courses-directory-form"),e=!1,s=["filter-categories","filter-instructors","search"],t=0;t<s.length;t++){var a=BBGetUrlParameter(window.location.search,s[t]),o=i.find('[name="'+s[t]+'"]').val();if(a!==o)switch(s[t]){case"filter-categories":case"filter-instructors":!a&&"all"===o||(e=!0);break;default:e=!0}if(e)break}e&&i.find('[name="current_page"]').val(1);var r=i.serialize(),n="grid";return i.find(".layout-list-view").hasClass("active")&&(n="list"),r+="&view="+n,d.ajax({method:"GET",url:bs_data.ajaxurl,data:r+"&action=buddyboss_lms_get_courses&_wpnonce="+bs_data.learndash.nonce_get_courses,success:function(e){var s=bs_data.learndash.course_archive_url;i.hasClass("bb-elementor-widget")&&(s=i.data("current_page_url"));var t=i.find('[name="current_page"]').val();if(isNaN(t)&&(t=1),1<t&&(s+="page/"+t+"/"),s+="?"+r,window.history.pushState({bblms_has_changes:!0,courses_html:e.data.html,type:i.find('[name="type"]').val()},"",s),i.find(".bs-dir-list").html(e.data.html),i.find("li.selected a span").text(e.data.count),e.data.scopes)for(var a in e.data.scopes)i.find("li#courses-"+a+" a span").text(e.data.scopes[a]).show();d(".courses-nav").find(".bb-icon-loader").remove()}}),!1},fetchCoursesPagination:function(){var i=d("#bb-courses-directory-form"),o=i.serialize(),e="list";return i.find(".layout-grid-view").hasClass("active")&&(e="grid"),o+="&view="+e,d.ajax({method:"GET",url:bs_data.ajaxurl,data:o+"&action=buddyboss_lms_get_courses&_wpnonce="+bs_data.learndash.nonce_get_courses,success:function(e){var s=bs_data.learndash.course_archive_url;i.hasClass("bb-elementor-widget")&&(s=i.data("current_page_url"));var t=i.find('[name="current_page"]').val();if(isNaN(t)&&(t=1),1<t&&(s+="page/"+t+"/"),s+="?"+o,window.history.pushState({bblms_has_changes:!0,courses_html:e.data.html,type:i.find('[name="type"]').val()},"",s),i.find(".bs-dir-list").html(e.data.html),i.find("li.selected a span").text(e.data.count),e.data.scopes)for(var a in e.data.scopes)i.find("li#courses-"+a+" a span").text(e.data.scopes[a]).show();d(".courses-nav").find(".bb-icon-loader").remove()}}),!1},course_archive_js:function(){d(document).on("change","#bb-courses-directory-form input[type=checkbox]",function(e){e.preventDefault(),window.BBLMS.fetchCourses()}),window.onpopstate=function(e){if(e.state&&(!!e.state.hasOwnProperty("bblms_has_changes")&&e.state.bblms_has_changes)){var s=d("#bb-courses-directory-form");s.find(".bs-dir-list").html(e.state.courses_html),s.find('[name="type"]').val(e.state.type),s.find(".component-navigation > li").each(function(){d(this).removeClass("selected"),BBGetUrlParameter(d(this).find(" > a").attr("href"),"type")===e.state.type&&d(this).addClass("selected")})}},d(document).on("click","#bb-course-list-grid-filters .grid-filters a",function(e){e.preventDefault(),d("#bb-course-list-grid-filters .grid-filters a").removeClass("active"),d(e.currentTarget).addClass("active");var s=d(e.currentTarget).data("view"),t=d(".ld-course-list-content");t.hasClass("list-view")&&t.removeClass("list-view"),t.hasClass("grid-view")&&t.removeClass("grid-view"),t.addClass(s+"-view"),d.ajax({method:"GET",url:bs_data.ajaxurl,data:"action=buddyboss_lms_save_view&option=bb_theme_learndash_grid_list&type="+s,success:function(e){}})}),d(document).ready(function(){if(d("body #bb-course-list-grid-filters").length){var e="";e=d("#bb-course-list-grid-filters .grid-filters .layout-grid-view").hasClass("active")?"grid-view":"list-view",d(".ld-course-list-content").addClass(e)}}),d(document).on("change","#bb-courses-directory-form [name='orderby'], #bb-courses-directory-form [name='filter-categories'], #bb-courses-directory-form [name='filter-instructors']",function(e){e.preventDefault(),window.BBLMS.fetchCourses()}),d(document).on("click","#bb-courses-directory-form .bs-sort-button",function(e){e.preventDefault(),e.currentTarget.classList.toggle("active"),d("#bs-courses-order-by").toggleClass("open")}),d(document).on("click","#bb-courses-directory-form .bb-lms-pagination a.page-numbers",function(e){e.preventDefault();var s=1,t=d(this).attr("href").split("/");if(0<t.length)for(var a=0;a<t.length;a++)if("page"===t[a]){s=t[a+1];break}d(this).closest("form").find('[name="current_page"]').val(s),window.BBLMS.fetchCoursesPagination()}),d(document).on("click","#bb-courses-directory-form .component-navigation a",function(e){e.preventDefault(),d(this).closest(".component-navigation").find("> li").removeClass("selected"),d(this).closest(".component-navigation").find("> li a span").hide(),d(this).closest(".component-navigation").find("> li a span").text(""),d(this).closest("li").addClass("selected").append('<i class="bb-icon-loader animate-spin"></i>'),d(this).closest("li").find("> a span").text(""),d(this).closest("li").find("> a span").show();var s=BBGetUrlParameter(d(this).attr("href"),"type");d(this).closest("form").find('[name="type"]').val(s),d(this).closest("form").find('[name="current_page"]').val(1),window.BBLMS.fetchCourses()}),document.addEventListener("click",function(e){var s=d("#course-order-dropdown"),t=e.target;if(s===t&&s.contains(t))return!1;for(var a=d("#bb-courses-directory-form .bs-dropdown"),i=d("#bb-courses-directory-form .bs-dropdown-link"),o=0;o<i.length;o++)i[o]===t||i[o].contains(t)||i[o].classList.remove("active");for(o=0;o<a.length;o++)a[o]!=t.parentElement.nextElementSibling&&a[o].classList.remove("open")}),d("#bb-courses-directory-form").on("submit",function(e){return window.BBLMS.fetchCourses(),!1}),d("#bb-courses-directory-form #bs_members_search").on("keypress",function(e){13==e.which&&d("#bb-courses-directory-form").submit()})},toggleTheme:function(){d(document).on("click","#bb-toggle-theme",function(e){e.preventDefault();var s="";d("body").hasClass("bb-dark-theme")?(d.removeCookie("bbtheme",{path:"/"}),d("body").removeClass("bb-dark-theme")):(d.cookie("bbtheme","dark",{path:"/"}),d("body").addClass("bb-dark-theme"),s="dark"),"undefined"!=typeof toggle_theme_ajax&&null!=toggle_theme_ajax&&toggle_theme_ajax.abort();var t={action:"buddyboss_lms_toggle_theme_color",color:s};"undefined"!=typeof toggle_theme_ajax&&null!=toggle_theme_ajax&&(toggle_theme_ajax=d.post(ajaxurl,t,function(e){}))})},learnDashSidePanel:function(){d(document).on("click",".header-maximize-link",function(e){e.preventDefault(),d("body").addClass("lms-side-panel-close"),d(".lms-topic-sidebar-wrapper").addClass("lms-topic-sidebar-close"),d.cookie("lessonpanel","closed",{path:"/"})}),d(document).on("click",".header-minimize-link",function(e){e.preventDefault(),d("body").removeClass("lms-side-panel-close"),d(".lms-topic-sidebar-wrapper").removeClass("lms-topic-sidebar-close"),d.removeCookie("lessonpanel",{path:"/"})}),d(window).width()<768&&(d("body").addClass("lms-side-panel-close"),d(".lms-topic-sidebar-wrapper").addClass("lms-topic-sidebar-close"),d(document).on("click",".header-minimize-link",function(e){e.preventDefault(),d("body").addClass("lms-side-panel-close-sm")}),d(document).click(function(e){var s=d(".header-minimize-link");s.is(e.target)||0!==s.has(e.target).length||d("body").removeClass("lms-side-panel-close-sm")})),d(window).on("resize",function(){d(window).width()<768&&d(document).click(function(e){var s=d(".header-minimize-link");s.is(e.target)||0!==s.has(e.target).length||d("body").removeClass("lms-side-panel-close-sm")})})},lms_course_single_js:function(){d(document).on("click",".learndash-course-single-nav",function(e){e.preventDefault(),d("ul.learndash-course-single-main-nav").find("li.current.selected").removeClass("current").removeClass("selected");var s=d(e.currentTarget).closest("li");s.addClass("current"),s.addClass("selected");var t=d(e.currentTarget).data("tab"),a=d(".learndash-course-single-tab-content");d.each(a,function(e){var s=d(this);s.data("tab")==t?s.removeClass("hide"):s.addClass("hide")})})},lms_single_course:function(){function e(){var e=d(".bb-learndash-banner").height(),s=d(".bb-thumbnail-preview .bb-preview-course-link-wrap");if(s.length)var t=s.height();else t=0;var a=e/2+t/2;820<d(window).width()&&d(".bb-single-course-sidebar.bb-preview-wrap").css({"margin-top":"-"+a+"px"})}function s(){var e=d("#main").width();d(".bb-learndash-banner .bb-course-banner-info.container").width(e)}d(".bb-course-video-overlay").magnificPopup({fixedBgPos:!0,fixedContentPos:!0,items:{src:".bb_course_video_details",type:"inline"},callbacks:{open:function(){d.magnificPopup.instance.close=function(){d(".mfp-container .mfp-content .bb_course_video_details video".length)&&(d("video").trigger("pause"),d.magnificPopup.proto.close.call(this))}}}}),e(),s(),d(window).on("resize",function(){s(),e()}),d(".bb-toggle-panel").on("click",function(e){e.preventDefault(),setTimeout(function(){s()},300),setTimeout(function(){s()},600)}),d(".lms-topic-sidebar-wrapper .lms-toggle-lesson").on("click",function(){setTimeout(function(){d(window).trigger("resize")},300)})},lms_user_profile_js:function(){d(document).on("click",".bb-lms-user-profile-tab",function(e){e.preventDefault(),d("ul.bb-lms-user-profile-tabs").find("li.current.selected").removeClass("current").removeClass("selected");var s=d(e.currentTarget).closest("li");s.addClass("current"),s.addClass("selected");var t=d(e.currentTarget).data("tab"),a=d(".bb-lms-user-profile-tab-content");d.each(a,function(e){var s=d(this);s.data("tab")==t?s.removeClass("hide"):s.addClass("hide")})})},quizDetails:function(){if(d("#bb-lms-quiz-id").length){var e=d("#bb-lms-quiz-id").val();d("div.quiz_progress_container").insertBefore(d(".wpProQuiz_results .wpProQuiz_resultTable")),d("#wpProQuiz_"+e).on("learndash-quiz-init",function(){})}},ajaxCompleteProcess:function(){d(document).ajaxComplete(function(e,s,t){if((t.data.indexOf("action=wp_pro_quiz_load_quiz_data")||t.data.indexOf("action=wp_pro_quiz_completed_quiz"))&&t.data&&""!=t.data){var a=t.data.split("&"),i="";for(var o in a)if(-1!=a[o].indexOf("action")){i=void 0!==(i=a[o].split("="))[1]?i[1]:"";break}if(""!=i&&"wp_pro_quiz_load_quiz_data"==i&&d(".wpProQuiz_resultTable").length){d(".bb_avg_progress").show();var r=new ProgressBar.Path("#bb_avg_shape",{duration:3e3,from:{color:"#ECCBFF",width:8},to:{color:"#ECCBFF",width:8},easing:"easeInOut",step:function(e,s){s.path.setAttribute("stroke",e.color),s.path.setAttribute("stroke-width",e.width)}}),n=s.responseJSON.averageResult;n=0<n?-n/100:0,r.animate(n)}if(""!=i&&"wp_pro_quiz_completed_quiz"==i&&d(".wpProQuiz_resultTable").length){a=decodeURIComponent(t.data).split("&");var l="";for(var o in a)if(-1!=a[o].indexOf("results")){l=void 0!==(l=a[o].split("="))[1]?l[1]:"",l=JSON.parse(l);break}void 0!==l.comp.result&&(l=l.comp.result);var c=new ProgressBar.Path("#quiz_shape_progress",{duration:3e3,from:{color:"#00A2FF",width:8},to:{color:"#7FE0FF",width:8},easing:"easeInOut",step:function(e,s){s.path.setAttribute("stroke",e.color),s.path.setAttribute("stroke-width",e.width)}});jQuery(".bb_progressbar_label").text(l+"%"),jQuery(".bb_progressbar_points").text(jQuery(".wpProQuiz_points").text()),0<l&&(l=-l/100),c.animate(l)}}})},quizUpload:function(){function e(){d("input.wpProQuiz_upload_essay[type=file]:not(.styled)").each(function(){var e=d(this),s=e.attr("id");e.addClass("styled"),e.after('<label for="'+s+'">'+bs_data.translation.choose_a_file_label+"</label>")}),d("input.wpProQuiz_upload_essay[type=file]").change(function(e){var s=d(this);s.next().html(s.val());0===s.val().length?s.next().html(bs_data.translation.choose_a_file_label):s.next().html(s.val().replace(/C:\\fakepath\\/i,""))})}e(),d(document).ajaxComplete(function(){e()})},courseViewCookie:function(){d("#bb-courses-directory-form .layout-grid-view").click(function(){d.cookie("courseview","grid")}),d("#bb-courses-directory-form .layout-list-view").click(function(){d.cookie("courseview","list")})},bbStickyLdSidebar:function(){var e=d("#masthead").outerHeight();if(768<d(window).width()&&0==d(".bb-ld-sticky-sidebar .ld-sidebar-widgets").length){d(".bb-ld-sticky-sidebar").stick_in_parent({offset_top:e+45});var s=0;d("body").hasClass("admin-bar")&&(s=32),d(".lms-topic-sidebar-data").css({"max-height":"calc(100vh - "+(e+s)+"px",top:e+s+"px"})}d(window).on("resize",function(){768<d(window).width()&&0==d(".bb-ld-sticky-sidebar .ld-sidebar-widgets").length?d(".bb-ld-sticky-sidebar").stick_in_parent({offset_top:e+45}):d(".bb-ld-sticky-sidebar").trigger("sticky_kit:detach")}),0<d(".wpProQuiz_matrixSortString").length&&d("html").addClass("quiz-sort")},setElementorSpacing:function(){if(0<d(".elementor-location-header").length){var e=d(".elementor-location-header").outerHeight();d(".lms-topic-sidebar-wrapper, #learndash-page-content").css({"min-height":"calc(100vh - "+e+"px)"})}},showQuizNavigation:function(){var e=d(".wpProQuiz_list").find(".wpProQuiz_listItem"),s=d("#bb-lms-quiz-navigation");if(e.length&&s.length){for(var t="<ul>",a=1;a<=e.length;a++)t+='<li><a href="#" class="bb-lms-quiz-questions" data-index="'+(a-1)+'">'+a+"</a></li>";t+="</ul>",s.html(t)}},StyleInputQuestion:function(){function e(){d('.wpProQuiz_questionInput:not([type="text"]):not([type="email"]):not([type="tel"]):not([type="date"])').each(function(){d(this).hasClass("bbstyled")||d(this).addClass("bbstyled").after('<span class="input-style"></span>')})}e(),d(document).ajaxComplete(function(){e()})},singleLesson:function(){document.getElementById("learndash-page-content")&&d("#learndash-page-content").scroll(function(){d(window).trigger("resize")})},singleTopic:function(){var e=d("body.single-sfwd-topic .lms-topic-item.current");e.length&&(e.closest("div").show(),e.parents().closest("li").removeClass("lms-lesson-turnover"));for(var s=[".sfwd-lessons-template-default",".sfwd-topic-template-default",".sfwd-quiz-template-default"],t=0;t<s.length;t++)0<d(s[t]+" #learndash-page-content #learndash-content #learndash-page-content .learndash_content_wrap #comments.comments-area").length&&d(s[t]+" #learndash-page-content #learndash-content #learndash-page-content .learndash_content_wrap #comments.comments-area").remove(),0<d(s[t]+" #learndash-page-content #learndash-content #learndash-page-content .learndash_content_wrap .ld-focus-comments").length&&d(s[t]+" #learndash-page-content #learndash-content #learndash-page-content .learndash_content_wrap .ld-focus-comments").remove()},singleQuiz:function(){var e=d("body.single-sfwd-quiz .lms-quiz-item.current");e.length&&(e.closest("div").show(),e.parents().closest("li").removeClass("lms-lesson-turnover"))}},d(document).ready(function(){window.BBLMS.init()})}(jQuery);