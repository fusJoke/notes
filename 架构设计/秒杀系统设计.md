## 秒杀系统设计原则

### 1.数据尽量少

用户请求数据尽量少。包括上传给系统的数据以及系统返回的数据。服务器在写网络时通常都要做压缩和字符编码，这些都非常消耗 CPU，所以减少传输的数据量可以显著减少 CPU 的使用



### 2.请求数量尽量少

用户请求的页面返回后，浏览器渲染的还有额外的请求。CSS/JavaScript、图片，以及 Ajax 请求等。

请求合并，合并css文件和js文件。

### 3.路径尽量短

所谓“路径”，就是用户发出请求到返回数据这个过程中，需求经过的中间的节点数。每经过一个节点，一般都会产生一个新的 Socket 连接

### 4.依赖要尽量少

所谓依赖，指的是要完成一次用户请求必须依赖的系统或者服务，这里的依赖指的是强依赖。

举个例子，比如说你要展示秒杀页面，而这个页面必须强依赖商品信息、用户信息，还有其他如优惠券、成交列表等这些对秒杀不是非要不可的信息（弱依赖），这些弱依赖在紧急情况下就可以去掉

### 5.不要单点





![image-20230109085434439](/Users/wangfusheng/Documents/notes/架构设计/.assets/image-20230109085434439.png)





## 动静分离的方案



### 何为动静数据

**“动态数据”和“静态数据”的主要区别就是看页面中输出的数据是否和 URL、浏览者、时间、地域相关，以及是否含有 Cookie 等私密数据**



**第一，你应该把静态数据缓存到离用户最近的地方**。静态数据就是那些相对不会变化的数据，因此我们可以把它们缓存起来。缓存到哪里呢？常见的就三种，用户浏览器里、CDN 上或者在服务端的 Cache 中



**第二，静态化改造就是要直接缓存 HTTP 连接**。相较于普通的数据缓存而言，你肯定还听过系统的静态化改造。静态化改造是直接缓存 HTTP 连接而不是仅仅缓存数据，如下图所示，Web 代理服务器根据请求 URL，直接取出对应的 HTTP 响应头和响应体然后直接返回，这个响应过程简单得连 HTTP 协议都不用重新组装，甚至连 HTTP 请求头也不需要解析。



## 如何做动静分离的改造



1. url唯一化
2. 分离浏览器相关的因素
3. 分离时间因素
4. 异步化低于因素
5. 去掉cookie





## 热点数据处理





## 流量销峰

