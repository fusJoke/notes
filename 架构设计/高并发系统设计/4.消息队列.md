## 消息队列

秒杀请求中的销峰

异步秒杀中的流程

秒杀模块之间的松耦合



### 如何保证消息只被消费一次

#### 消息为什么会丢失

+ 消息从生产者写入到消息队列的过程
+ 消息在消息队列中存储场景
+ 消息被消费者消费的过程

<img src="/Users/wangfusheng/Documents/notes/架构设计/高并发系统设计/.assets/image-20221225135841555.png" alt="image-20221225135841555" style="zoom:33%;" /> 

1. 消息在生产过程中丢失了消息
   消息重传，重试2-3次

2. 生产、消费过程中增加消息幂等性的保证

   消息生产过程kafka

